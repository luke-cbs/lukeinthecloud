---
import ArticleCard from "@components/ArticleCard.astro";
import Layout, { PageType } from "../layouts/Layout.astro";

export type Article = {
	published_timestamp: string;
	social_image: string;
	cover_image: string;
	description: string;
	title: string;
	url: string;
};

const hasOverflow = false;
const page: PageType = "blog";
let articles: Article[] = [];
---

<Layout hasOverflow={hasOverflow} page={page} title="Welcome to my Blog.">
	<div class="md:w-5/6 p-4 w-full overflow-y-scroll">
		<h1 class="text-left block uppercase font-raleway font-bold text-3xl">
			Recent Articles
		</h1>
		<div
			class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 grid-flow-row auto-rows-auto gap-6 mt-10"
		>
			{
				articles.map((article: Article, index: number) => (
					<ArticleCard
						index={index}
						title={article.title}
						bannerImage={
							article.cover_image
								? article.cover_image
								: article.social_image
						}
						url={article.url}
						date={article.published_timestamp}
					/>
				))
			}
		</div>
	</div>
</Layout>

<script is:inline>
	fetch("/articles", {
		method: "GET",
	})
		.then((response) => response.json())
		.then((articlesRes) => {
			console.log(articles);
			articles = articlesRes;
		});
</script>

<style>
	:global(article:first-child),
	:global(article:nth-child(2)) {
		@apply lg:col-span-2 col-span-1;
	}

	:global(article:not(first-child)) {
		@apply col-span-1;
	}
</style>
